<?php

/*jobOffers([10,8,7,6,5,4,3,2,1],
    [100, 11, 1],[1, 11, 100]);*/
//jobOffers([3],[1,4],[3,5]);
//jobOffers([4, 8, 7], [4,2],[8,4]);

//jobOffers([1, 1, 1], [1],[1]);

/*jobOffers(array_fill(0,10000,rand(1,100000)),
array_fill(0,10000,rand(1,100000)),
array_fill(0,10000,rand(1,100000))
    );
*/

jobOffers([306068239,328330709,192938888,930052851,578466200,224956775,786318604,732997972,99729846,822403756,598787751,449732381,768084046,255327357,325402913,571329812,612114768,717287803,522571916,580047412,638741585,494756660,923845849,722808246,851822373,736369432,185514192,209398104,133803821,238948516,325216684,300982831,832245036,720297627,406825655,708654884,573705581,18495771,346140543,957068716,39403649,408394851,64476274,884826192,180213942,758251763,601015607,251125391,622988605,562902837,209835088,497286966,825849426,984614149,913802917,72124280,877012540,908718800,465086380,371724790,699871969,678377845,170795384,267062097,826481320,611278936,582327901,396959257,832238239,620812872,618271856,889275624,986489077,265244841,293257455,939791313,666936269,330623705,858942755,726114485,610144157,616649611,828354227,463038605,126103926,939446019,51093614,16128149,991731551,491159625,734460852,381913004,856337187,603537538,64332364,515923142,641518578,651108210,869672692,443896800],
    [598594619,299318707,595847020,326847136,398609849,553957644,704440471,167273560,873104380,100419947,501079922,141655831,798257817,234845558,307792554,123470196,420679946,283891409,842724597,821319022,260035059,785872085,647583082,98366095,91850540,863231483,411951732,462122098,913274733,154783991,83672242,417725949,125213057,395890620,725770277,363219156,126185255,235711974,182944955,971912313,6411166,162906288,754430216,554794028,55045652,474617576,235074124,725034198,349148421,68325652,882773007,796985545,779887627,462105632,97934786,743687974,489640867,856072092,859435986,209733143,843070690,236258780,251575434,30446750,735916286,491911744,737817028,943699088,257156731,268150268,189652674,697254577,463365578,808176485,62705879,552423731,298490058,352691087,527235511,263881737,497953031,758899412,806487991,975869864,652889187,877467975,453885576,116597241,478491352,883019310,808827512,295512381,729856885,192228190,410919356,412214868,139388069,823310023,723735564,671129853],
    [943382007,444027591,913868509,639862276,619947866,649114620,963425950,924755676,986338312,752671533,983211883,824485217,916445078,853183443,922351084,572448739,905119081,500581256,938426609,973519065,832226581,906009034,942132863,327498279,432602194,952356093,690249937,994019501,956084991,832562812,375383170,773358446,676386951,464130519,968704100,556609724,510103595,544935712,706018464,976938062,426561361,729190744,825210922,872980316,701526226,884667402,608207508,860423522,771206462,532009079,920618647,977337991,800073980,622905146,966702398,770609301,565200691,882699867,907182513,414400249,885471536,343724821,412625421,118428403,752312679,561392317,832687706,999542162,997159859,835970162,417644015,949515428,632077304,977328618,273860923,625578084,681136775,760641552,533051176,758273655,655931444,983975089,918338362,990589917,894981935,932282206,691225150,943012224,819243698,948045222,908097502,799122231,785623350,702540762,458514721,797655833,701475491,955507458,881353053,682809827]);
jobOffers2([306068239,328330709,192938888,930052851,578466200,224956775,786318604,732997972,99729846,822403756,598787751,449732381,768084046,255327357,325402913,571329812,612114768,717287803,522571916,580047412,638741585,494756660,923845849,722808246,851822373,736369432,185514192,209398104,133803821,238948516,325216684,300982831,832245036,720297627,406825655,708654884,573705581,18495771,346140543,957068716,39403649,408394851,64476274,884826192,180213942,758251763,601015607,251125391,622988605,562902837,209835088,497286966,825849426,984614149,913802917,72124280,877012540,908718800,465086380,371724790,699871969,678377845,170795384,267062097,826481320,611278936,582327901,396959257,832238239,620812872,618271856,889275624,986489077,265244841,293257455,939791313,666936269,330623705,858942755,726114485,610144157,616649611,828354227,463038605,126103926,939446019,51093614,16128149,991731551,491159625,734460852,381913004,856337187,603537538,64332364,515923142,641518578,651108210,869672692,443896800],
    [598594619,299318707,595847020,326847136,398609849,553957644,704440471,167273560,873104380,100419947,501079922,141655831,798257817,234845558,307792554,123470196,420679946,283891409,842724597,821319022,260035059,785872085,647583082,98366095,91850540,863231483,411951732,462122098,913274733,154783991,83672242,417725949,125213057,395890620,725770277,363219156,126185255,235711974,182944955,971912313,6411166,162906288,754430216,554794028,55045652,474617576,235074124,725034198,349148421,68325652,882773007,796985545,779887627,462105632,97934786,743687974,489640867,856072092,859435986,209733143,843070690,236258780,251575434,30446750,735916286,491911744,737817028,943699088,257156731,268150268,189652674,697254577,463365578,808176485,62705879,552423731,298490058,352691087,527235511,263881737,497953031,758899412,806487991,975869864,652889187,877467975,453885576,116597241,478491352,883019310,808827512,295512381,729856885,192228190,410919356,412214868,139388069,823310023,723735564,671129853],
    [943382007,444027591,913868509,639862276,619947866,649114620,963425950,924755676,986338312,752671533,983211883,824485217,916445078,853183443,922351084,572448739,905119081,500581256,938426609,973519065,832226581,906009034,942132863,327498279,432602194,952356093,690249937,994019501,956084991,832562812,375383170,773358446,676386951,464130519,968704100,556609724,510103595,544935712,706018464,976938062,426561361,729190744,825210922,872980316,701526226,884667402,608207508,860423522,771206462,532009079,920618647,977337991,800073980,622905146,966702398,770609301,565200691,882699867,907182513,414400249,885471536,343724821,412625421,118428403,752312679,561392317,832687706,999542162,997159859,835970162,417644015,949515428,632077304,977328618,273860923,625578084,681136775,760641552,533051176,758273655,655931444,983975089,918338362,990589917,894981935,932282206,691225150,943012224,819243698,948045222,908097502,799122231,785623350,702540762,458514721,797655833,701475491,955507458,881353053,682809827]);

/*jobOffers2([306068239,328330709,192938888,930052851,578466200,224956775,786318604,732997972,99729846,822403756,598787751,449732381,768084046,255327357,325402913,571329812,612114768,717287803,522571916,580047412,638741585,494756660,923845849,722808246,851822373,736369432,185514192,209398104,133803821,238948516,325216684,300982831,832245036,720297627,406825655,708654884,573705581,18495771,346140543,957068716,39403649,408394851,64476274,884826192,180213942,758251763,601015607,251125391,622988605,562902837,209835088,497286966,825849426,984614149,913802917,72124280,877012540,908718800,465086380,371724790,699871969,678377845,170795384,267062097,826481320,611278936,582327901,396959257,832238239,620812872,618271856,889275624,986489077,265244841,293257455,939791313,666936269,330623705,858942755,726114485,610144157,616649611,828354227,463038605,126103926,939446019,51093614,16128149,991731551,491159625,734460852,381913004,856337187,603537538,64332364,515923142,641518578,651108210,869672692,443896800],
    [598594619,299318707,595847020,326847136,398609849,553957644,704440471,167273560,873104380,100419947,501079922,141655831,798257817,234845558,307792554,123470196,420679946,283891409,842724597,821319022,260035059,785872085,647583082,98366095,91850540,863231483,411951732,462122098,913274733,154783991,83672242,417725949,125213057,395890620,725770277,363219156,126185255,235711974,182944955,971912313,6411166,162906288,754430216,554794028,55045652,474617576,235074124,725034198,349148421,68325652,882773007,796985545,779887627,462105632,97934786,743687974,489640867,856072092,859435986,209733143,843070690,236258780,251575434,30446750,735916286,491911744,737817028,943699088,257156731,268150268,189652674,697254577,463365578,808176485,62705879,552423731,298490058,352691087,527235511,263881737,497953031,758899412,806487991,975869864,652889187,877467975,453885576,116597241,478491352,883019310,808827512,295512381,729856885,192228190,410919356,412214868,139388069,823310023,723735564,671129853],
    [943382007,444027591,913868509,639862276,619947866,649114620,963425950,924755676,986338312,752671533,983211883,824485217,916445078,853183443,922351084,572448739,905119081,500581256,938426609,973519065,832226581,906009034,942132863,327498279,432602194,952356093,690249937,994019501,956084991,832562812,375383170,773358446,676386951,464130519,968704100,556609724,510103595,544935712,706018464,976938062,426561361,729190744,825210922,872980316,701526226,884667402,608207508,860423522,771206462,532009079,920618647,977337991,800073980,622905146,966702398,770609301,565200691,882699867,907182513,414400249,885471536,343724821,412625421,118428403,752312679,561392317,832687706,999542162,997159859,835970162,417644015,949515428,632077304,977328618,273860923,625578084,681136775,760641552,533051176,758273655,655931444,983975089,918338362,990589917,894981935,932282206,691225150,943012224,819243698,948045222,908097502,799122231,785623350,702540762,458514721,797655833,701475491,955507458,881353053,682809827]);*/
/**
 * Complete the function below.
 */
function jobOffers($scores, $lowerLimits, $upperLimits) {

    $nTotalScoreLimit = 10 ** 5;
    $aScores = array_fill(0, sizeof($lowerLimits), 0);
    sort($scores, SORT_NUMERIC);
    asort($lowerLimits, SORT_NUMERIC);
    $mappingLower = array_keys($lowerLimits);
    sort($lowerLimits, SORT_NUMERIC);
    asort($upperLimits, SORT_NUMERIC);
    $mappingUpper = array_keys($upperLimits);
    sort($upperLimits, SORT_NUMERIC);
    $nScores = min(sizeof($scores), $nTotalScoreLimit);
    $nQueries = min(sizeof($lowerLimits), $nTotalScoreLimit);

    if ($nScores == 0) {
        return $aScores;
    }
    if ($nQueries == 0) {
        return $aScores;
    }

    $currentLowestCandidateScoreMatchingLowestLowerLimitPosition = $nScores -1;

    $currentLowestCandidateScoreMatchingLowestLowerLimit = $scores[$currentLowestCandidateScoreMatchingLowestLowerLimitPosition];

    //We don't have any candidate that match the lowest possible limit
    if ($currentLowestCandidateScoreMatchingLowestLowerLimit < $lowerLimits[0]) {
        return $aScores;
    }

    $currentHighestCandidateScoreMatchingLowestUpperLimit = $scores[0];

    //We don't have any candidate that match the lowest possible upper limit
    if ($currentHighestCandidateScoreMatchingLowestUpperLimit > $upperLimits[0]) {
        return $aScores;
    }

    $i = $j = 0;
    $currentLowestCandidateScoreMatchingLowestLowerLimitPosition = 0;
    $currentHighestCandidateScoreMatchingLowestUpperLimitPosition = 0;

    while ($i < $nQueries ) {

        if ($currentLowestCandidateScoreMatchingLowestLowerLimitPosition == $nScores) {

            $aLowerLimitPositions[$mappingLower[$i]] = false;
            $i++;

        } else {

            $currentLowestCandidateScoreMatchingLowestLowerLimit = $scores[$currentLowestCandidateScoreMatchingLowestLowerLimitPosition];
            $lowerLimit = $lowerLimits[$i];

            if ($currentLowestCandidateScoreMatchingLowestLowerLimit < $lowerLimit) {
                $currentLowestCandidateScoreMatchingLowestLowerLimitPosition++;
            } else {
                $aLowerLimitPositions[$mappingLower[$i]] = $currentLowestCandidateScoreMatchingLowestLowerLimitPosition;
                $i++;
            }
        }
    }

    while ($j < $nQueries) {

        if ($currentHighestCandidateScoreMatchingLowestUpperLimitPosition == $nScores) {
            $currentHighestCandidateScoreMatchingLowestUpperLimitPosition--;
            $j++;
        } else {

            $currentHighestCandidateScoreMatchingLowestUpperLimit = $scores[$currentHighestCandidateScoreMatchingLowestUpperLimitPosition];
            $upperLimit = $upperLimits[$j];

            if ($currentHighestCandidateScoreMatchingLowestUpperLimit <= $upperLimit) {
                $aUpperLimitPositions[$mappingUpper[$j]] = $currentHighestCandidateScoreMatchingLowestUpperLimitPosition;
                $currentHighestCandidateScoreMatchingLowestUpperLimitPosition++;
            } else {
                $currentHighestCandidateScoreMatchingLowestUpperLimitPosition--;
                $j++;
            }
        }
    }

    for ($i = 0; $i < $nQueries; $i++) {
        if ($aLowerLimitPositions[$i] === false) {
            $aScores[$i] = 0;
        } else {
            $aScores[$i] = 1 + $aUpperLimitPositions[$i] - $aLowerLimitPositions[$i];
        }
    }

    return $aScores;
}

function jobOffers2($scores, $lowerLimits, $upperLimits) {

    $nTotalScoreLimit = 10 ** 5;
    $nScoreLimit = 10 ** 9;
    $aScores = array_fill(0, sizeof($lowerLimits), 0);
    sort($scores, SORT_NUMERIC);
    $nScores = min(sizeof($scores), $nTotalScoreLimit);
    $nQueries = min(sizeof($lowerLimits), $nTotalScoreLimit);

    if ($nQueries == 0) {
        return $aScores;
    }

    //foreach ($lowerLimits as $key => $lowerLimit) {
    for ($key = 0; $key < $nQueries; $key++) {
        $lowerLimit = $lowerLimits[$key];
        $minScoreCandidatePos = $maxScoreCandidatePos = false;

        for ($i = 0; $i < $nScores; $i ++) {

            if ($minScoreCandidatePos === false) {
                if ($scores[$i] >= $lowerLimit) {
                    $minScoreCandidatePos = $i;
                }
            }

            if ($maxScoreCandidatePos === false) {
                if ($scores[$nScores-1 - $i] <= $upperLimits[$key]) {
                    $maxScoreCandidatePos = $nScores-1 - $i;
                }
            }

            if ($maxScoreCandidatePos !== false && $minScoreCandidatePos !== false) {
                $aScores[$key] = 1 + $maxScoreCandidatePos - $minScoreCandidatePos;
                break;
            }

            if ($minScoreCandidatePos === false && $maxScoreCandidatePos === false && ($i > $nScores - $i)) {
                break;
            }
        }
    }

    return $aScores;
}
?>
